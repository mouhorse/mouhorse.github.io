<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Lucky | Lucky</title><meta name="author" content="刘同学"><meta name="copyright" content="刘同学"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Mysql - wolai 笔记12306项目会被问到基础count 1 * 列名count 1和*会统计所有行count 列名，如果某一行为空，那么这一行就不算。列名为主键的话，列名最快列名不为主键，1比列明快只有一个字段的话count*最优blob和textblob存储的是二进制文件text存储的是文本日志缓存读数据的话会把目标数据所在的页移动到BufferPool缓存修改数据后，会把旧数据">
<meta property="og:type" content="website">
<meta property="og:title" content="Lucky">
<meta property="og:url" content="https://mouhorse.github.io/myJava/mysql/mysql.html">
<meta property="og:site_name" content="Lucky">
<meta property="og:description" content="Mysql - wolai 笔记12306项目会被问到基础count 1 * 列名count 1和*会统计所有行count 列名，如果某一行为空，那么这一行就不算。列名为主键的话，列名最快列名不为主键，1比列明快只有一个字段的话count*最优blob和textblob存储的是二进制文件text存储的是文本日志缓存读数据的话会把目标数据所在的页移动到BufferPool缓存修改数据后，会把旧数据">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mouhorse.github.io/img/tou.png">
<meta property="article:published_time" content="2025-03-26T05:02:16.748Z">
<meta property="article:modified_time" content="2025-03-26T05:01:39.572Z">
<meta property="article:author" content="刘同学">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mouhorse.github.io/img/tou.png"><link rel="shortcut icon" href="/img/th.png"><link rel="canonical" href="https://mouhorse.github.io/myJava/mysql/mysql.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><meta name="google-site-verification" content="Bc4tRfMaw7XnqS-KACjzLzmUvYz5yXYVWsfdC3iux4k"/><meta name="baidu-site-verification" content="codeva-E9MpML203E"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Lucky',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'page'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/tou.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fas fa-music"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page" id="page-header" style="background-image: url(/img/background.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/th.png" alt="Logo"><span class="site-name">Lucky</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fas fa-music"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="page-site-info"><h1 id="site-title"></h1></div></header><main class="layout" id="content-inner"><div id="page"><div class="container" id="article-container"><!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../css/wolai.css"/><title>Mysql - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="Mysql" class="main-title"></div></div></header><article><div id="pReePN9HMBr5ALKtrW4HH5" class="wolai-block wolai-text"><div><span class="inline-wrap">12306<span class="jill"></span>项目会被问到</span></div></div><h1 id="cgzLbLNeQe6fsAyfMApN3G" class="wolai-block"><span class="inline-wrap">基础</span></h1><h2 id="g3sDEz6NZmACBJv8pCX3Jt" class="wolai-block"><span class="inline-wrap">count 1 * 列名</span></h2><ul class="wolai-block"><li id="pbRjh44RhRyB3dQQGBMJi"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">count 1<span class="jill"></span>和*会统计所有行</span></li><li id="5axGXv5Ee6c9g6RiUXTkyG"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">count 列名，如果某一行为空，那么这一行就不算。</span></li></ul><div id="ewmMotDn4RZthmHrLGTpNW" class="wolai-block wolai-text"><div><span class="inline-wrap">列名为主键的话，列名最快</span></div></div><div id="sNwCRxrWwffX78WCVPeuG2" class="wolai-block wolai-text"><div><span class="inline-wrap">列名不为主键，1<span class="jill"></span>比列明快</span></div></div><div id="xoY4kXd5BCyzgYJrGqa2o5" class="wolai-block wolai-text"><div><span class="inline-wrap">只有一个字段的话<span class="jill"></span>count*最优</span></div></div><h2 id="36e588LrJVVFFfpa6urgS6" class="wolai-block"><span class="inline-wrap">blob<span class="jill"></span>和<span class="jill"></span>text</span></h2><div id="uUQjcVwnRAM8aEAV6m5bts" class="wolai-block wolai-text"><div><span class="inline-wrap">blob<span class="jill"></span>存储的是二进制文件</span></div></div><div id="bhwXPWwW3mi6hNmDUgHRR8" class="wolai-block wolai-text"><div><span class="inline-wrap">text<span class="jill"></span>存储的是文本</span></div></div><h1 id="uxoKGmmDLJzTKYfWkJe25r" class="wolai-block"><span class="inline-wrap">日志</span></h1><h2 id="sLZQW31cspHzmamdR6ePGv" class="wolai-block"><span class="inline-wrap">缓存</span></h2><div id="ip4Q77WsvvZAGTRHCC5pgw" class="wolai-block wolai-text"><div><span class="inline-wrap">读数据的话会把目标数据所在的页移动到<span class="jill"></span>BufferPool<span class="jill"></span>缓存</span></div></div><div id="2EDPgmkoLXJVAWHDeRWVDu" class="wolai-block wolai-text"><div><span class="inline-wrap">修改数据后，会把旧数据放到<span class="jill"></span>undolog，修改语句保存到<span class="jill"></span>redolog，新数据写回磁盘文件</span></div></div><div id="eEUSMJ7T1M1TK8wkMZkbtC" class="wolai-block"><figure class="wolai-center" style="width: 672.897163275831px; flex-direction: column"><img src="media/image.png" style="width: 100%"/></figure></div><ul class="wolai-block"><li id="2QBVvP8V46Gbotm6fwTqtU"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">缓冲池：位于内存中，类似于<span class="jill"></span>cache。减少了对磁盘的<span class="jill"></span>IO</span></li><li id="b4DPkRUwfAbqj9TzxHgEqd"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">数据页：磁盘管理的最小单元，里面包含的是行数据。</span></li></ul><h2 id="22hvraV3wbppAmyuTbaECe" class="wolai-block"><span class="inline-wrap">log</span></h2><ul class="wolai-block"><li id="vW4rwSbiayjosyFYZc9EeC"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>redo log</b></span><span class="inline-wrap">：记录的是修改数据的操作，常用于</span><span class="blue inline-wrap">数据持久化。</span></li><li id="iMofz2uHxQtAn9amhch9LH"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>undo log</b></span><span class="inline-wrap">：记录数据修改前的信息，用来</span><span class="green inline-wrap"><u>提供回滚</u></span><span class="green inline-wrap">和<span class="jill"></span>MVCC。</span></li><li id="gg2WQWjWgn1QfP7gcWjbQ3"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>bin log</b></span><span class="inline-wrap">：MySQL<span class="jill"></span>提供的，记录的是数据库的所有操作。主要用于主从复制。</span></li></ul><div id="oUrm3rugE5hCZdzp4Qpvcj" class="wolai-block wolai-text"><div><span class="inline-wrap"><u>binlog 记录的是逻辑 SQL 语句</u></span></div></div><div id="i6aU4Axx9pq5DTxaApwrYP" class="wolai-block wolai-text"><div><span class="inline-wrap"><u>redo log 记录的是物理数据页的修改操作</u></span></div></div><div id="uucTfZq7sRzoaXmKyDEApK" class="wolai-block"><figure class="wolai-center" style="width: 704.6728626527453px; flex-direction: column"><img src="media/image_1.png" style="width: 100%"/></figure></div><h2 id="v5TPkaq7FMejyiufACJS2M" class="wolai-block"><span class="inline-wrap">WAL</span></h2><div id="3urCjnkJGaC5HbjB6AYtrU" class="wolai-block wolai-text"><div><span class="inline-wrap">writ ahead log，先写日志再修改数据库</span></div></div><div id="kc8U6wa6NSAoTUXNCbCMdt" class="wolai-block wolai-text"><div><span class="inline-wrap">先写日志，确保系统在发生故障时可以通过重做日志恢复数据</span></div></div><h2 id="g6BEXSqPXLffJnNL56qnV8" class="wolai-block"><span class="inline-wrap">redo log<span class="jill"></span>刷盘</span></h2><div id="8p91K3ezmMKdoeaSFgrytR" class="wolai-block wolai-text"><div><span class="inline-wrap">redo log<span class="jill"></span>的写入不是直接写入磁盘，而是先写入</span><span class="inline-wrap"><code>redo log buffer</code></span><span class="inline-wrap">缓冲区</span></div></div><ul class="wolai-block"><li id="r2e5GYwzg7QTLkqFRGLDCd"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">缓存写满后会写入磁盘</span></li><li id="6tEZ1X6N7mhSXDGiAaL5MS"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">事务提交后会写入磁盘</span></li><li id="wxU9pC4VpBLvHS7zPAZ7rh"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">后台线程定时控制写入磁盘</span></li></ul><h2 id="mcJaW9DaUzM5ugwE21YdRM" class="wolai-block"><span class="inline-wrap">两阶段提交？？？？？</span></h2><h1 id="gZNZZY4QJ9YPmdL4eKvFW6" class="wolai-block"><span class="inline-wrap">优化</span></h1><h2 id="carDViuQcMcTMLDuRJLPyf" class="wolai-block"><span class="inline-wrap">定位慢查询</span></h2><div id="kGrRs134kkvfLN5oHrmP1d" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>可能的原因</b></span><span class="inline-wrap">：聚合查询，多表查询，表数据查询量过大，深度分页查询。</span></div></div><div id="irgo33sCVC9shsbc9GWADP" class="wolai-block wolai-text"><div><span class="inline-wrap">表象：页面加载过慢，接口压力响应时间过长。</span></div></div><div id="8FJxMzKavb3gjEjiFKZg5q" class="wolai-block wolai-text"><div><span class="inline-wrap">方法：查看慢查询日志。</span><span class="inline-wrap"><code>show variables like &#39;long_query_time&#39;;</code></span><span class="inline-wrap">查看当前的 long_query_time 值</span></div></div><div id="9kaWbKvKCtkRr6djZ5eyrt" class="wolai-block wolai-text"><div><span class="inline-wrap">超过一秒就认为是慢查询了。</span></div></div><h2 id="tSGdYEfXqsvQsHxYNUDYmo" class="wolai-block"><span class="inline-wrap">SQL<span class="jill"></span>执行顺序</span></h2><ol class="wolai-block"><li id="7bJGN22zyM2mF8fwp6S2nf"><div class="marker"></div><span class="inline-wrap">发送<span class="jill"></span>SQL<span class="jill"></span>语句</span></li><li id="b6mE7vHgLwRnbiveSmFqBE"><div class="marker"></div><span class="inline-wrap">查询缓存，有的话直接返回</span></li><li id="v8RhydEfjb8h5amG4zqWC7"><div class="marker"></div><span class="inline-wrap">判断语句是否有语法错误</span></li><li id="rv2UCqRXoEEyx8qjPBwiqT"><div class="marker"></div><span class="inline-wrap">生成执行计划</span></li><li id="s3XXKDmQUfkHmVqwLGthdL"><div class="marker"></div><span class="inline-wrap">调用存储引擎查找数据</span></li></ol><h2 id="whQtw6fEu3oxzrUydJzhs" class="wolai-block"><span class="inline-wrap">如何优化慢查询</span></h2><ul class="wolai-block"><li id="9FHibFMTMBpeZQ6eEGBteP"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">聚合查询：新增临时表</span></li><li id="jGxrbFuxdHu7nATscPxtVF"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">多表查询：优化<span class="jill"></span>sql<span class="jill"></span>结构</span></li><li id="aSZXFhj4hw2NvMN8VczhJ5"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">表数据查询量过大：添加索引</span></li><li id="vtVFm3chDGidssiiYbz7Ep"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">避免使用<span class="jill"></span>select *</span></li></ul><h3 id="g3gsmxUSm3q4gPYuoeCsXv" class="wolai-block"><span class="inline-wrap"><b>分析</b></span></h3><div id="voinRfSkNmYhywtaNPM6aY" class="wolai-block wolai-text"><div><span class="inline-wrap">使用<span class="jill"></span>EXPLAIN<span class="jill"></span>或者<span class="jill"></span>DESC<span class="jill"></span>可以获得<span class="jill"></span>sql<span class="jill"></span>执行<span class="jill"></span>select<span class="jill"></span>语句的信息，获得语句执行清理。</span></div></div><div id="igPQfDzoR5qsVssBMprTgX" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_2.png" style="width: 100%"/></figure></div><ul class="wolai-block"><li id="fynQzb21C3tiCTxYLg28pt"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">possible_keys：可能用到的索引</span></li><li id="hikuRpJi6s3AdCo5ezQEJF"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">key：实际命中的索引，和<span class="jill"></span>key_len<span class="jill"></span>搭配查看是否命中索引</span></li><li id="ansMCNsDsxq35nnYKcEPNP"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">key_len：索引占用的大小</span></li><li id="wf869ddJbFJGcL5MhjuTwx"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Extra：附加信息</span></li></ul><h2 id="5YgPd3FPEUscJcDnYqZaBo" class="wolai-block"><span class="inline-wrap">SQL<span class="jill"></span>优化</span></h2><ul class="wolai-block"><li id="h2x2HjZ5B22QxGzX6mCTHs"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">表设计优化</span><ul class="wolai-block"><li id="xwRkaEzF7TS5E9uw7DaCE3"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">char<span class="jill"></span>和<span class="jill"></span>varchar</span></li></ul></li><li id="fNkNpyoa3fGHvSB9Ek1q4A"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">SQL<span class="jill"></span>语句优化</span><ul class="wolai-block"><li id="b5KbDwvKioMz2znbX51DQu"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">避免直接使用<span class="jill"></span>select *</span></li><li id="goPe4KQaFimaobxbawNWcG"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">避免索引失效的写法</span></li></ul></li><li id="qDiLqoTvwz3VjitWCxtAz2"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">主从复制，读写分离</span></li></ul><div id="j8YXQoNtB5FBqHpCuYBoEY" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_3.png" style="width: 100%"/></figure></div><h1 id="wqQBa2WxGPGtNigN4qR1tH" class="wolai-block"><span class="inline-wrap">索引</span></h1><h2 id="2u85wySsZsEzYJv4ZeAV23" class="wolai-block"><span class="inline-wrap">定义</span></h2><div id="oJhHRgMTYhy6JotARYPsgt" class="wolai-block wolai-text"><div><span class="inline-wrap">在数据库上维护着<span class="jill"></span>B+<span class="jill"></span>数，以某种方式指向数据，这样就可以实现高级查找算法，提升效率。</span></div></div><div id="8YDWuxyZfndqhU8PRPfy1v" class="wolai-block wolai-text"><div><span class="inline-wrap">没有索引的话，数据库就会进行全表扫描，导致效率很低。</span></div></div><div id="mugHbffpCW65iVEJcFmrfj" class="wolai-block wolai-text"><div><span class="inline-wrap">mysql<span class="jill"></span>底层使用的</span><span class="inline-wrap"><b>B+<span class="jill"></span>树</b></span><span class="inline-wrap">，时间复杂度为<span class="jill"></span>O(logn)</span></div></div><div id="opjNuPhHW8pdHmL2FSvLgt" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8b+%E6%A0%91/%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8b+%E6%A0%91.html"><span>为什么用B+树</span></a></div><div id="wD2JUL82LMgtjkALZymrjW" class="wolai-block wolai-text"><div><span class="inline-wrap">二叉树缺点：容易变成只有左子树的极端情况</span></div></div><div id="rGCHHFLPSj6tdmuPaX1xBw" class="wolai-block wolai-text"><div><span class="inline-wrap">红黑树缺点：当数据量多的时候，树会变的特别高</span></div></div><div id="aAJQypRSiYdXNQiNX3Rd4X" class="wolai-block wolai-text"><div><span class="inline-wrap">B+<span class="jill"></span>树一层存的数据比二叉树多，效率高。（B+<span class="jill"></span>树叶子节点不存储数据，这是和<span class="jill"></span>B<span class="jill"></span>树的唯一区别）</span></div></div><div id="oDk6d83uXgBYbYLasdZkSr" class="wolai-block"><figure class="wolai-center" style="width: 583.1775415057202px; flex-direction: column"><img src="media/image_4.png" style="width: 100%"/></figure></div><h2 id="7YeNMcpmU5ukyGKJJUXHDM" class="wolai-block"><span class="inline-wrap">索引创建原则</span></h2><ul class="wolai-block"><li id="8SzjoWnf9SnrAbMeYWSu21"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">查询数据量大，且查询比较频繁。单表超过十万数据。</span></li><li id="2Anj3AKXknAbrokj8bYrat"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">在查询条件、排序、分组操作的字段建立索引。</span></li><li id="hMg4iyMJTjCaigrXT3myVk"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">尽量选择区分度高的列作为索引。</span></li><li id="ctbRqXBMPzgyQxS5VYkv5D"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">如果在字符串类型的列上建立索引，且字符串较长，建立前缀索引。</span></li><li id="nnMR3EorBU9N2H7yFMv62K"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">尽量使用</span><span class="inline-wrap">联合索引</span></li><li id="8RgpCyguW9t2MWRaQxLYAj"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">索引数量并不是多多益善，索引也是需要维护的。</span></li></ul><div id="uDJNFAFnbg3Gh3ap9kDEsR" class="wolai-block wolai-text"><div><span class="inline-wrap">如果数据表较小，也不适合创建索引，没必要。</span></div></div><h2 id="tSHsJu92jwJhGR6V8QdSU9" class="wolai-block"><span class="inline-wrap">聚簇索引</span></h2><div id="GXiX9t2AeWEzshXXZ2nNQ" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>聚簇索引</b></span><span class="inline-wrap">：将数据和索引结构存到了一起，叶子节点存储</span><span class="inline-wrap"><b>行数据</b></span><span class="inline-wrap">。该索引必须有且只能有一个</span></div><div id="dF2rTCU2QKhEmYH97G4EGA" class="wolai-block wolai-text"><div><span class="inline-wrap">选取规则：</span></div><ul class="wolai-block"><li id="fzCDe5EkdydGtAetugcT7r"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">有主键，主键就是聚集索引</span></li><li id="pzviFA1xesV3d3GHQt7cqo"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">没主键，第一个<span class="jill"></span>UNIQUE<span class="jill"></span>的列为聚集索引</span></li><li id="aaeyU2ZQek8wEhaqcRgvAC"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">上面两个都没有，则自动生成一列<span class="jill"></span>id<span class="jill"></span>作为聚集索引。</span></li></ul></div></div><div id="f3jQbDRxTDdwvwfFVx6VvL" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>非聚簇索引</b></span><span class="inline-wrap">：将数据与索引分开存储，索引结构的叶子节点关联的是对应的</span><span class="inline-wrap"><b>主键</b></span><span class="inline-wrap">。可以存在多个，自己添加的。</span></div></div><div id="qPwF1XuXNVpn8hVCgxKm8t" class="wolai-block wolai-text"><div><span class="inline-wrap">比如下图聚簇索引存储的是行数据，非聚簇索引存储的是主键位置。</span></div></div><div id="rrpmFChEgkkv9mpkjzK96h" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_5.png" style="width: 100%"/></figure></div><h2 id="qqZ81LjrZL4dm6g2YpM931" class="wolai-block"><span class="inline-wrap">回表查询</span></h2><div id="xzx8o8V8QMxc1LPkwDDmxy" class="wolai-block wolai-text"><div><span class="inline-wrap">还是上图，主键是<span class="jill"></span>id，给<span class="jill"></span>name<span class="jill"></span>构建了非聚集索引</span></div></div><div id="xv5Jc45WpZ5muDTd7jxBJ3" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>回表查询</b></span><span class="inline-wrap">：当查找<span class="jill"></span>Arm<span class="jill"></span>的所有信息的时候，先通过二级索引找到主键值，再根据主键去聚簇索引找到该行的数据</span></div></div><h2 id="jcZWHB4uxozZb7dUecMH6p" class="wolai-block"><span class="inline-wrap">覆盖索引</span></h2><div id="pqT5GXDgGyXHSHouthLUFT" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>定义</b></span><span class="inline-wrap">：查询使用的该索引包含自己需要的所有信息。既</span><span class="bg-fluorescent_green inline-wrap">不是回表查询的就是覆盖索引</span><span class="inline-wrap">。</span></div></div><div id="a22W5Piroc4E4zdf5UseqJ" class="wolai-block wolai-text"><div><span class="inline-wrap">就是查询数据的时候，比如说在非聚簇索引内就能找到所有需要的数据，就是覆盖索引。比如：非聚集索引是<span class="jill"></span>name，查询的是<span class="jill"></span>id<span class="jill"></span>和<span class="jill"></span>name，所以就不用回表查询了，这就是覆盖索引。</span></div></div><h2 id="kdQn1son12FAz9hN5fiqQH" class="wolai-block"><span class="inline-wrap">哈希索引</span></h2><div id="nqGpDAvtzJiyNz1jX3nTQH" class="wolai-block wolai-text"><div><span class="inline-wrap">在等值查询上比<span class="jill"></span>B+<span class="jill"></span>树高效，其他的方面都不如<span class="jill"></span>B+<span class="jill"></span>树，不能范围查询，不能模糊查询</span></div></div><div id="9whvDYmnaQEG5H1VW1aMvz" class="wolai-block"><figure class="wolai-center" style="width: 346px; flex-direction: column"><img src="media/image_6.png" style="width: 100%"/></figure></div><h2 id="iJqCh1wjKS1xqWKqRQ7sGr" class="wolai-block"><span class="inline-wrap">Mysql<span class="jill"></span>超大分页</span></h2><div id="szjHgkur221UNMb8cuoaLh" class="wolai-block wolai-text"><div><span class="inline-wrap">数据量比较大时，进行<span class="jill"></span>limit<span class="jill"></span>查询的时候，越往后分页查询效率越低。</span></div></div><div id="x88FKpTZvFnnHLdAvsCuDP" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_7.png" style="width: 100%"/></figure></div><div id="xrtpYCNVSmEvNx38F5JVcz" class="wolai-block wolai-text"><div><span class="inline-wrap">优化思路：</span><span class="red inline-wrap">先使用覆盖索引，避开回表查询</span><span class="inline-wrap">，然后再子查询关联这两个表进行<span class="jill"></span>select *</span></div></div><div id="vHRfqg2m9pEKTHGvBqw8o7" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_8.png" style="width: 100%"/></figure></div><h2 id="dYbxoYTq3Nr5tCHBP2k3Za" class="wolai-block"><span class="inline-wrap">最左前缀</span></h2><ul class="wolai-block"><li id="gLBAXMpPioZqjZAhkif78X"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">复合索引没有遵循左前缀原则，（A，B，C）的索引，只查（B，C）</span></li><li id="o8URWofiX4aR2fG61bTttP"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">使用了 NOT 或 != 操作符</span></li><li id="6SV3RWf7JXvDXvDegZ1EtK"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">使用了通配符<span class="jill"></span>%<span class="jill"></span>开头（“%abc”），如果在末尾使用通配符就没有问题（“abc%”）。</span></li><li id="p4puEkwMWWF2DQhYyLhHo8"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">使用 IS NOT NULL</span></li></ul><div id="8g3o3J9rhpwWebwXZMEwqU" class="wolai-block wolai-text"><div><span class="inline-wrap">比如说定义了联合索引，有三个：name，statue，address</span></div></div><div id="7CMBRXrYkB3nsdLueWr9F3" class="wolai-block wolai-text"><div><span class="inline-wrap">如果查询的时候条件是<span class="jill"></span>name<span class="jill"></span>和<span class="jill"></span>statue，那么能命中索引</span></div></div><div id="oP4EyGJNQeTUNbNPtH6doR" class="wolai-block wolai-text"><div><span class="inline-wrap">应为要符合最左前法则，name<span class="jill"></span>必须要有</span></div></div><div id="ryS92BQ69VqNCaU5PcNmPv" class="wolai-block wolai-text"><div><span class="inline-wrap">如果查询<span class="jill"></span>statue<span class="jill"></span>和<span class="jill"></span>address，则不能命中这个索引</span></div></div><div id="5BBahPSXRDDgdWZ43m6MuF" class="wolai-block wolai-text"><div><span class="inline-wrap">查询<span class="jill"></span>name<span class="jill"></span>和<span class="jill"></span>address<span class="jill"></span>的话，能命中，但是效果和仅用<span class="jill"></span>name<span class="jill"></span>是一样的</span></div></div><div id="j9JQVzKr6AhtHv5NoqqaXF" class="wolai-block wolai-text"><div><span class="inline-wrap">应为跳过了<span class="jill"></span>address<span class="jill"></span>左边的<span class="jill"></span>statue</span></div></div><h1 id="cQWVUvw1z3RcYLi6HN9XGc" class="wolai-block"><span class="inline-wrap">锁</span></h1><div id="gsc6bFpbj7adqjYszgRzDk" class="wolai-block wolai-text"><div><span class="inline-wrap">表锁，行锁，页锁。</span></div></div><div id="9xMwmzyGRD2wFM6hSzB9Cn" class="wolai-block wolai-text"><div><span class="inline-wrap">全局锁是锁定数据库不能被更新,在备份数据库的时候使用</span></div></div><div id="qjAVJs3Nke336Ur9tGJLTL" class="wolai-block wolai-text"><div><span class="inline-wrap">表锁是锁定一个表，有读锁和写锁，在大改表结构的时候使用。</span></div></div><h2 id="kCzo8bug66XHF2hE5BdEP7" class="wolai-block"><span class="inline-wrap">行锁</span></h2><div id="iVvnsaZjjuQEtpvCwm6Ack" class="wolai-block wolai-text"><div><span class="inline-wrap">对某一行的数据进行加锁，</span><span class="inline-wrap"><u>行锁可能会导致死锁</u></span></div></div><h2 id="8AUgr76tAm8tkfY1TzZTjA" class="wolai-block"><span class="inline-wrap">间隙锁</span></h2><div id="pZgxfJrr3fkNSxTwaWjQUB" class="wolai-block wolai-text"><div><span class="inline-wrap">比如说锁住<span class="jill"></span>id10~20<span class="jill"></span>的间隙，那么新插入的数据<span class="jill"></span>id<span class="jill"></span>不能在这个范围。</span></div></div><h2 id="6fsoRgya1MBwdpkrgETNzz" class="wolai-block"><span class="inline-wrap">意向锁</span></h2><div id="uaAcPf4HqCtQMar9VyufZp" class="wolai-block wolai-text"><div><span class="inline-wrap">行锁和表锁想对同一个表操作的时候，两者也是互斥的</span></div></div><div id="brTjeJsque9pXKKDHrqUWN" class="wolai-block wolai-text"><div><span class="inline-wrap">可以使用意向锁当中间人，意向锁不同意，则代表有其他锁(表锁或者行锁)在控制这个表。</span></div></div><div id="mkiKNsaLrbAfyqPWkXqhjk" class="wolai-block wolai-text"><div><span class="inline-wrap">获得意向锁后才可以加表锁或者行锁</span></div></div><div id="eFUKfUhVF4Ah4qoxPidmgq" class="wolai-block"><figure class="wolai-center" style="width: 448px; flex-direction: column"><img src="media/image_9.png" style="width: 100%"/></figure></div><h1 id="9o2jNvKR94ST2MXffom5ST" class="wolai-block"><span class="inline-wrap">事务</span></h1><h2 id="nfnXKy53QyDYXin1jijfHR" class="wolai-block"><span class="inline-wrap">事务是什么</span></h2><div id="26xXpXWiVpbgwfNjrYg9px" class="wolai-block wolai-text"><div><span class="inline-wrap">一组操作的集合，要么都成功，要么都失败</span></div></div><ul class="wolai-block"><li id="eKqencAKFnDHTo4fqMrWFk"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">原子性：不可分割的最小单元。</span><span class="bg-fluorescent_green inline-wrap">undo log<span class="jill"></span>保证</span></li><li id="mbZuBRH1SqANgbBMB8Cduz"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">一致性：完成后所有数据都保证一致状态，比如转账后<span class="jill"></span>A<span class="jill"></span>少十块钱，B<span class="jill"></span>多十块钱。</span></li><li id="fmSHJLbipZ8oQActTyaSgq"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">隔离性：不受外部影响。</span><span class="bg-fluorescent_green inline-wrap">MVCC<span class="jill"></span>保证</span></li><li id="N8VDwACE1PkPi3xpVYtbw"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">持久性：改变是永久代。</span><span class="bg-fluorescent_green inline-wrap">redo log<span class="jill"></span>保证</span></li></ul><h2 id="fFZ5c7SChkdUPJ2YhahwTJ" class="wolai-block"><span class="inline-wrap">并发事务带来的问题</span></h2><ul class="wolai-block"><li id="dSjY2LgdFCdzKAki9gyUch"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">脏读：读到了其他事务未提交的数据。</span></li><li id="hmo1ZrPS3Hu5C5TrFamQKK"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">不可重复读：一个事务在执行过程中前后查询到的结果不一样。</span></li><li id="htz9ECd4TsLEcZz5SA2iLh"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">幻读：一个数据查询时没找到对应的行，但是插入的时候，发现对应的行已经出现了。</span></li></ul><h2 id="4zekSSvgzSVdwvJSL2xHqk" class="wolai-block"><span class="red inline-wrap">事务隔离级别</span></h2><div id="tr6rDwMCHiY1Hr9kPXKBNn" class="wolai-block wolai-text"><div><span class="inline-wrap">对事务进行隔离</span></div></div><div id="965n45qgUTrRJxG6BKGrCU" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_10.png" style="width: 100%"/></figure></div><h2 id="6vkQHmRbpLcqJeZeZDDFEG" class="wolai-block"><span class="bg-fluorescent_yellow inline-wrap">MVCC<span class="jill"></span>多版本并发控制</span></h2><div id="mWUsMi7LQyGpBKpu6gocSF" class="wolai-block wolai-text"><div><span class="inline-wrap">多个事务并发的情况下确定该访问哪个版本。</span></div></div><h3 id="254oyQqQVHy7tDeP7VewwV" class="wolai-block"><span class="inline-wrap">实现原理</span></h3><div id="b4uQWjdnfZug6Ce3YJjiQA" class="wolai-block wolai-text"><div><span class="inline-wrap">数据库有隐藏字段：</span></div></div><ul class="wolai-block"><li id="cpUFYKk3y2C8otV69toML3"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">DB_TRX_ID ：</span></li><li id="kfYEq6CYSWD994QLgaYSXX"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">DB_ROLL_PTR：</span></li></ul><div id="tTbsvpuiZAgD1mJYTfbB2J" class="wolai-block"><figure class="wolai-center" style="width: 605.6074469482479px; flex-direction: column"><img src="media/image_11.png" style="width: 100%"/></figure></div><div id="wn3HbcBoM3Gtmk6zqTkaEK" class="wolai-block wolai-text"><div><span class="inline-wrap">版本链，存储在<span class="jill"></span>undo log<span class="jill"></span>里面，像个链表一样，方便进行回滚。</span></div></div><div id="qUqDSVCxdDq37Q97uw7WRQ" class="wolai-block"><figure class="wolai-center" style="width: 600.9345499810546px; flex-direction: column"><img src="media/image_12.png" style="width: 100%"/></figure></div><div id="fNyYY3YxpjqEitPpLeCVCV" class="wolai-block wolai-text"><div><span class="inline-wrap">Readview：</span></div></div><div id="beGBXdbhqH1UnhnPpmEgKZ" class="wolai-block wolai-text"><div><span class="inline-wrap">当前事务：指行当前事务时生成的版本号</span></div></div><div id="6JJkzGEqg7EDqVqTjCAzVc" class="wolai-block wolai-text"><div><span class="inline-wrap">未提交事务：再运行，但是还未执行结束，从小到大排序</span></div></div><div id="uemYttjPciFUWSbDCsLfVu" class="wolai-block wolai-text"><div><span class="inline-wrap">未开始事务：还没开始</span></div></div><div id="8HXPrRxzizN3yyabhHqNMH" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_13.png" style="width: 100%"/></figure></div><div id="cYX3GD5DhRrRcuUkHNCJt8" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>如果是事务隔离级别是读已提交，就从版本链里面找到历史数据进行读取</b></span><span class="inline-wrap">。</span></div></div><h2 id="oNf85zgCxCrvGuUZG8BRt3" class="wolai-block"><span class="inline-wrap">流程</span></h2><ol class="wolai-block"><li id="pfoVLXHREuu1ak1T1fGAvj"><div class="marker"></div><span class="inline-wrap">如果记录的版本号等于当前<span class="jill"></span>readview<span class="jill"></span>里面的版本号，</span><span class="inline-wrap"><code>可以访问</code></span><span class="inline-wrap">。</span></li><li id="6yfgaw3fdtNABdRM6EhwT"><div class="marker"></div><span class="inline-wrap">如果记录的版本号小于未提交事务，那么表明当前数据在生成当前<span class="jill"></span>readview<span class="jill"></span>时已经提交，</span><span class="inline-wrap"><code>可以访问</code></span><span class="inline-wrap">。</span></li><li id="5ZyhJW1YDXG2w2pvU4MZfn"><div class="marker"></div><span class="inline-wrap">如果记录的版本号大于等于未开始事务<span class="jill"></span>id，证明这个版本是当前<span class="jill"></span>readview<span class="jill"></span>后面来的，</span><span class="inline-wrap"><code>不能访问</code></span><span class="inline-wrap">。</span></li><li id="L7peQiPeboYtahLpDX8xY"><div class="marker"></div><span class="inline-wrap">如果版本号在未提交事务和未开始事务之间，则也</span><span class="inline-wrap"><code>不能访问</code></span><span class="inline-wrap">，往下继续查找</span></li></ol><hr id="mxLRSFyoqNJETXkoMTsQt9" class="wolai-block"/><ul class="wolai-block"><li id="ehStnVB2CZpnh5tj2Dbi6B"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">当前读：读取的是最新版本数据，会对读取数据进行加锁</span></li><li id="fn68J6fSDknmDCskuawBNc"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">快照读：可能读取的是旧数据，不加锁</span><ul class="wolai-block"><li id="nUYw7jQrHcCZyjWHo3qkw7"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">RC：每次查询，都生成一个快照读</span></li><li id="tJK2WG2dvcNRn36e2rryxS"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">RR：开启事务后的第一个<span class="jill"></span>select<span class="jill"></span>生成一个快照，后面<span class="jill"></span>select<span class="jill"></span>都用这个</span></li></ul></li></ul><div id="dXQgzThqNAWnP25S9DjPyH" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_14.png" style="width: 100%"/></figure></div><div id="jREPbshdc2G2nMkg7FEYre" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_15.png" style="width: 100%"/></figure></div><h1 id="ur28oTbuLbRCPJzX4AhirX" class="wolai-block"><span class="inline-wrap">高可用</span></h1><h2 id="7Pk8qJ6iVdsRnzb3D5tdCp" class="wolai-block"><span class="inline-wrap">主从同步</span></h2><div id="7kGDFk2BTpZcr6X5G2GUBs" class="wolai-block wolai-text"><div><span class="inline-wrap">主库负责写数据，从库负责读数据</span></div></div><div id="iTLbbExEpNSgJxCiqwR38T" class="wolai-block wolai-text"><div><span class="inline-wrap">主库更新后将数据同步更新到从库</span></div></div><h3 id="swgQ5Mo3iZ6M9TaPWoD8QS" class="wolai-block"><span class="inline-wrap">同步延迟</span></h3><div id="qDZKixFRxqoVxWPSpjh7x3" class="wolai-block wolai-text"><div><span class="inline-wrap">当大量客户端对主库进行写操作后，从库来不及更新，导致延迟。</span></div></div><div id="ggvdHpjUmuLzdyzgWCreEc" class="wolai-block wolai-text"><div><span class="inline-wrap">解决方案</span></div></div><ul class="wolai-block"><li id="XPrhWze7J7CwqJQKMiiPG"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">写操作后的读让主服务器来执行</span></li><li id="973iqetymEr39NuHamJvb3"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">二次读：从库读取失败后从主库里面读</span></li><li id="8iwK436CCBYDeX2AQ8QSea"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">关键业务读写操作全部指向主机，非关键业务采用读写分离</span></li></ul><div id="sZV2DY5mCcGkFUWCwZi9JG" class="wolai-block"><figure class="wolai-center" style="width: 458px; flex-direction: column"><img src="media/image_16.png" style="width: 100%"/></figure></div><h2 id="2FaAFFkEgtPqRt2Bgi3euR" class="wolai-block"><span class="inline-wrap">主从复制</span></h2><div id="uGNQcwJUNNrAnKaKzSxgcg" class="wolai-block wolai-text"><div><span class="inline-wrap">当从数据库挂了或者新来了从数据库</span></div></div><div id="j5ncLZLupuFwSvPn5PKY1B" class="wolai-block wolai-text"><div><span class="inline-wrap">bin log<span class="jill"></span>实现</span></div></div><h2 id="wCRL8RnFhMAj7j7p4FJQot" class="wolai-block"><span class="inline-wrap">不停机扩容</span></h2><ul class="wolai-block"><li id="q9NqE2FYXBJKeVm8qLEeVA"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">在线双写，查询走老库：主要进行数据迁移工作</span></li><li id="mWZHPZK7SboSyYa36yru7B"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">在线双写，查询走新库：完成了数据的读写和校验</span></li><li id="4c516VBSrZgyRhKA5S63eC"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">旧库下线：旧库没有新的请求到达，就可以下线了。</span></li></ul><h1 id="5PtFM8MtYpn1aeS7pqQZyL" class="wolai-block"><span class="inline-wrap">分库分表</span></h1><div id="oL9kLfTuoBMnjgJHWuoU4e" class="wolai-block wolai-text"><div><span class="inline-wrap">sharding-jdbc</span></div></div><h2 id="678UF4iW5XnqtYjjgmTD2g" class="wolai-block"><span class="inline-wrap">种类</span></h2><div id="5zyChVEX8qUC3SkM9prGUD" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_17.png" style="width: 100%"/></figure></div><hr id="uRfUKuL7KjWGn9ZNUfypKH" class="wolai-block"/><div id="neiFSMCDnGRbrHxB8ZhHt4" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>垂直分库</b></span><span class="inline-wrap">：不同的库存储不同业务的表</span></div></div><div id="myVibnfopSABDMSiheUTbj" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_18.png" style="width: 100%"/></figure></div><hr id="9kWSrDB5kcGUx2QVJPgdjH" class="wolai-block"/><div id="jJJFJUizZM8GZ7VPfevj5G" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>垂直分表</b></span><span class="inline-wrap">：把一张表常用的列和不常用的列分到不同的库存储，比如大容量数据单独存储</span></div></div><div id="4jsu5bz32eFttFEqiXH79S" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_19.png" style="width: 100%"/></figure></div><hr id="jAu6Z7hjKA8628Ade98jQd" class="wolai-block"/><div id="6bMieySx5BwZy9UKw4V22" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>水平分库</b></span><span class="inline-wrap">：把一个库的数据拦腰截断，分到不同的数据库内。表格式相同，但是存储的数据不同。</span></div></div><div id="ciFbqpSyMNZMxUw9ToddU6" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_20.png" style="width: 100%"/></figure></div><hr id="uV1wJnH7ZChNStrtK2yM87" class="wolai-block"/><div id="cccc2jMiJ2tp3z7UXZXM7x" class="wolai-block wolai-text"><div><span class="red inline-wrap"><b>水平分表</b></span><span class="inline-wrap">：把一个表的数据拆分到多个表内，但可以存到同一个库内</span></div></div><div id="vRHPLoVf4eE4GB5ED9U6jJ" class="wolai-block"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_21.png" style="width: 100%"/></figure></div><h2 id="fLLe2VeHayMfRDx7SREbW3" class="wolai-block"><span class="inline-wrap">分片策略</span></h2><ul class="wolai-block"><li id="j6dMBoxSvPq6C4FYqPACdR"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">范围分片：适用于分片键规律的场景。</span></li><li id="7Wa39fF2FMmUA9eRSixKft"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">哈希分片</span></li><li id="tXyzCC8J5UDXap5n7G3T4w"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">配置路由分片：适用于分片键不规律的场景。</span></li></ul><h2 id="qPdFFqaoNbPXCeGkVciziT" class="wolai-block"><span class="inline-wrap">带来的问题</span></h2><ul class="wolai-block"><li id="oLo8WgnZkhjqFqbUMTL9qa"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">事务问题</span></li><li id="uGMmrYnHBNSxEDdX1ojKTQ"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">跨库<span class="jill"></span>join<span class="jill"></span>问题</span></li><li id="sQ7b8GwVVqqw8ySqHJD6kG"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">数据迁移，容量规划，扩容等问题</span></li><li id="4EHGoHUtTeRaxK67FSM7wP"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">ID<span class="jill"></span>自增问题，只能雪花算法了</span></li></ul></article><footer></footer></body></html></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/tou.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">刘同学</div><div class="author-info-description">欢迎光临我的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mouhorse"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><center><b>欢迎来到我的博客！</b><br>可以交换友链<br>联系方式：<a href="mailto:485182274@qq.com" title="发送邮件" class="anno_content">485182274@qq.com</a></center></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025-02-25/Hexo%E6%9C%AC%E5%9C%B0%E4%B8%8E%E4%BA%91%E7%AB%AF%E5%B8%83%E5%B1%80%E4%B8%8D%E5%90%8C%E5%A4%84%E7%90%86%E5%8A%9E%E6%B3%95/" title="Hexo本地与云端布局不同处理办法"><img src="https://freeimghost.net/images/2025/03/03/bj2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo本地与云端布局不同处理办法"/></a><div class="content"><a class="title" href="/2025-02-25/Hexo%E6%9C%AC%E5%9C%B0%E4%B8%8E%E4%BA%91%E7%AB%AF%E5%B8%83%E5%B1%80%E4%B8%8D%E5%90%8C%E5%A4%84%E7%90%86%E5%8A%9E%E6%B3%95/" title="Hexo本地与云端布局不同处理办法">Hexo本地与云端布局不同处理办法</a><time datetime="2025-02-25T02:40:14.000Z" title="发表于 2025-02-25 10:40:14">2025-02-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025-02-24/%E8%A7%A3%E5%86%B3-Hexo-%E9%83%A8%E7%BD%B2%E5%88%B0-GitHub-Pages-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%A4%B1%E6%95%88/" title="解决 Hexo 部署到 GitHub Pages 自定义域名失效"><img src="https://freeimghost.net/images/2025/03/03/bj3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="解决 Hexo 部署到 GitHub Pages 自定义域名失效"/></a><div class="content"><a class="title" href="/2025-02-24/%E8%A7%A3%E5%86%B3-Hexo-%E9%83%A8%E7%BD%B2%E5%88%B0-GitHub-Pages-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%A4%B1%E6%95%88/" title="解决 Hexo 部署到 GitHub Pages 自定义域名失效">解决 Hexo 部署到 GitHub Pages 自定义域名失效</a><time datetime="2025-02-24T03:00:27.000Z" title="发表于 2025-02-24 11:00:27">2025-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025-02-23/Butterfly-%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/" title="Butterfly 个性化配置教程"><img src="https://freeimghost.net/images/2025/03/03/bj7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Butterfly 个性化配置教程"/></a><div class="content"><a class="title" href="/2025-02-23/Butterfly-%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/" title="Butterfly 个性化配置教程">Butterfly 个性化配置教程</a><time datetime="2025-02-23T07:35:17.000Z" title="发表于 2025-02-23 15:35:17">2025-02-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025-02-23/Hexo%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BF%AE%E6%94%B9%E4%B8%BB%E9%A2%98/" title="Hexo安装并修改主题"><img src="https://freeimghost.net/images/2025/03/03/bj1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo安装并修改主题"/></a><div class="content"><a class="title" href="/2025-02-23/Hexo%E5%AE%89%E8%A3%85%E5%B9%B6%E4%BF%AE%E6%94%B9%E4%B8%BB%E9%A2%98/" title="Hexo安装并修改主题">Hexo安装并修改主题</a><time datetime="2025-02-23T07:18:17.000Z" title="发表于 2025-02-23 15:18:17">2025-02-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024-10-07/MNE%E8%84%91%E7%94%B5%E9%A2%84%E5%A4%84%E7%90%86/" title="MNE脑电预处理"><img src="/img/bj8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MNE脑电预处理"/></a><div class="content"><a class="title" href="/2024-10-07/MNE%E8%84%91%E7%94%B5%E9%A2%84%E5%A4%84%E7%90%86/" title="MNE脑电预处理">MNE脑电预处理</a><time datetime="2024-10-07T08:09:14.000Z" title="发表于 2024-10-07 16:09:14">2024-10-07</time></div></div></div></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/" style="font-size: 1.1em; color: #999">毕业设计</a> <a href="/tags/%E7%A7%91%E7%A0%94/" style="font-size: 1.1em; color: #999">科研</a> <a href="/tags/%E8%84%B1%E5%9D%91%E7%AC%94%E8%AE%B0/" style="font-size: 1.37em; color: #99a4b2">脱坑笔记</a> <a href="/tags/%E9%AB%98%E6%95%B0/" style="font-size: 1.37em; color: #99a4b2">高数</a> <a href="/tags/Python/" style="font-size: 1.5em; color: #99a9bf">Python</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.37em; color: #99a4b2">数据结构</a> <a href="/tags/EEG/" style="font-size: 1.1em; color: #999">EEG</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 1.23em; color: #999ea6">机器学习</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站信息</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">23</div></div><div class="webinfo-item"><div class="item-name">运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2018-08-31T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">21.4k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-03-26T07:18:54.057Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/background.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By 刘同学</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.3</a></div><div class="footer_custom_text">活出个样子给自己看</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="恭,喜,发,财" data-fontsize="15px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="想找什么" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>